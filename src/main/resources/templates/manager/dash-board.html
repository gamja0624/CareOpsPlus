<!DOCTYPE html>

<html xmlns:th="http://www.thymleaf.org" lang="ko">
	<head>
		<meta charset="UTF-8">
		<!-- 관리자 manager -->
		<title>CareOps+ | 대시보드</title>
		<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		
		<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
		<link th:href="@{/css/style.css}" rel="stylesheet">
		<link th:href="@{/css/web-settings.css}" rel="stylesheet">
		
		<style type="text/css">
			/* 콘텐츠 영역 레이아웃 잡기 */
			.content { display: grid; grid-template-columns: 1fr 1fr; width: 1340px; } /* 두 개의 동일한 열 생성 */ 
			.s-m { margin-right: 20px; }
		
			/* 기본 세팅 */
			.title { width: 700px; height: 40px; margin-bottom: 30px; }
			.sub-title { font-size: 25px; }
			.status { text-align: right; margin: 10px 0 40px 0; }
			.icon-next { width: 30px; margin-left: 10px; }
		
			/* 서비스 미리보기 */
			.service { margin-bottom: 35px; width: 700px; display: flex; justify-content: space-between; } 
			.box { 
				padding: 10px;
				width: 160px; /* 180 */
				height: 100px; /* 120 */
				background-color: #13254C; 
				border-radius: 10px;
				display: inline-block;
		 	}
 		 	.box-text { font-size: 20px; color: white; }
		 	.box-sub { display: flex; align-items: center; font-size: 35px; font-weight: 900;  }
		 	
		 	/* 의료기기 상태 현황 */
		 	.medical-table { padding: 20px; margin-top: 70px; width: 700px; height: 500px; border: 3px solid #13254C; border-radius: 10px; }
		 	
		 	/* 캘린더 */
		 	.calendar { 
				display: flex;
				margin: 70px 0 30px 0; 
				width: 500px; 
				height: 300px; 
				border: 3px solid #13254C; 
				border-radius: 10px; 
				background-color: #13254C;
			}
		 	/* 내 민원 */
		 	.claim-content { padding: 20px; margin-bottom: 15px; width: 500px; height: 95px; border: 3px solid #13254C; border-radius: 10px; }
		 	.claim-add { display: flex; width: 500px; }
		 	.claim-add-next { margin-left: auto; margin-bottom: 5px; }
		 	
		</style>
	</head>

	<body>
		<!-- 사이드바 -->
		<th:block th:replace="~{/common/side-bar}"></th:block>
		
		<!-- 컨텐츠 영역 -->
		<div class="content">
			<div class="section s-m">
				
    		<!-- 로그인 이후 담당 부서와 담당자 이름 제어 -->
				<h1 class="title" th:text="${ session.department + ' ' + session.name + '님, 반갑습니다.' }"></h1>
				
				<!-- 서비스 미리보기 -->
				<div class="service">
					<!-- 민원 -->
					<div class="box box-text">마이 페이지
						<a th:href="@{/mypage}" class="box-text box-sub">이동
							<img alt="이동" th:src="@{/img/icon-next-w.png}" class="icon-next">
						</a>
					</div>
					
					<!-- 민원 -->
					<div class="box box-text">부서 민원 보러가기
						<a href="" class="box-text box-sub" th:text="'총 ' + ${ claimCnt } + '건'">
							<img alt="이동" th:src="@{/img/icon-next-w.png}" class="icon-next">
						</a>
					</div>
					
					<!-- 의료기기 -->
					<div class="box box-text">부서 민원 보러가기
						<a href="" class="box-text box-sub" th:text="'총 ' + ${ medicalCnt } + '개'">
							<img alt="이동" th:src="@{/img/icon-next-w.png}" class="icon-next">
						</a>
					</div>
					
					<!-- 시설물 -->
					<div class="box box-text">시설물 관리
						<a href="" class="box-text box-sub">이동
							<img alt="이동" th:src="@{/img/icon-next-w.png}" class="icon-next">
						</a>
					</div>
				</div>
				
				<!-- 의료기기 상태 현황  -->
				<div class="medical-table">
					<!-- 의료기기 상태 날짜 -->
					<div class="status">
						<p class="sub-title">의료기기 상태 현황</p>
						<p class="today"></p>
					</div>
					
					<!-- 세로 막대 그래프 -->
					<canvas id="medicalChart"></canvas>
				</div>
			</div>
			
			<div class="section">
				<!-- 캘린더 -->
				<div class="calendar">
					<section class="ftco-section">
						<div class="calendar-first" id="calendar_first">
					    <div class="calendar_header">
				        <button class="switch-month switch-left"> <i class="fa fa-chevron-left"></i></button>
				         <h2></h2>
				        <button class="switch-month switch-right"> <i class="fa fa-chevron-right"></i></button>
					    </div>
					    <div class="calendar_weekdays"></div>
					    <div class="calendar_content"></div>
						</div>
					</section>
				</div>
				
				<!-- 내가 쓴 민원 (최신순 3가지 ) -->
				<div class="claim">
					<div class="claim-add">
						<a href="" class="claim-add-next">더보기</a>
					</div>
		 			<div class="claim-content">a</div>
		 			<div class="claim-content">a</div>
		 			<div class="claim-content">a</div>
				</div>
			</div>
		</div>
		
		<script th:src="@{/js/jquery.min.js}" ></script>
	  <script th:src="@{/js/main.js}" ></script>
	  <script th:src="@{/js/bootstrap.bundle.min.js}" ></script>
  	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  	
	  <script type="text/javascript">
			// className 이 today 인 p 태그 오늘 날짜로 기본값 설정
			var pList = document.querySelectorAll('.today');
			
			pList.forEach(function (item) {
				item.innerText = new Date().toISOString().substring(0, 10);
			})
			
			// 세로 막대 그래프
			var ctx = document.getElementById('medicalChart');
	    var myChart = new Chart(ctx, {
	      type: 'bar',
	      data: {
	        labels: ['정상', '점검', '수리', '노후', '만료'],
	        datasets: [{
	          label: '현황 ',
	          data: ['[[${MedicalStatus.normal}]]', '[[${MedicalStatus.check}]]', 
	        	  '[[${MedicalStatus.repair}]]', '[[${MedicalStatus.old}]]', '[[${MedicalStatus.expire}]]'],
	          backgroundColor: [
	            'rgba(0, 204, 0, 0.5)',    // 정상
	            'rgba(255, 159, 64, 0.5)', // 점검
	            'rgba(54, 162, 235, 0.5)', // 수리
	            'rgba(255, 206, 86, 0.5)', // 노후
	            'rgba(255, 99, 132, 0.5)'  // 만료
	          ],
	          borderColor: [
	            'rgba(0, 204, 0, 1)',    // 정상
	            'rgba(255, 159, 64, 1)', // 점검
	            'rgba(54, 162, 235, 1)', // 수리
	            'rgba(255, 206, 86, 1)', // 노후
	            'rgba(255, 99, 132, 1)'  // 만료
	          ],
	          borderWidth: 1
	        }]
	      },
	      options: {
	    	  legend: {
    	        display: false // label 숨기기
    	    },
	        scales: {
	          yAxes: [{
	            ticks: {
	              beginAtZero: true
	            }
	          }]
	        },
	      }
	    });
			
	  </script>
	  
	</body>
</html>