<!DOCTYPE html>
<html xmlns:th="http://www.thymleaf.org">
<head>
  	<meta charset="UTF-8">
  	<title>CareOps+ | 안전관리</title>
  	<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
  	<link th:href="@{/css/web-settings.css}" rel="stylesheet">
  	<style type="text/css">
      /* 테이블 */
      .layout-table { text-align: center; }
      .table { margin: 5% auto; display: inline-table; width: 650px; text-align: center; }
      .table-head { font-weight: bold; font-size: 20px; }
      .table-row { line-height: 20px; border-bottom: 1px solid #d9d9d9; }
      .table-row>th,td { padding: 4px; vertical-align: middle; }
      .btn-line { text-align: center; }
      
      /* 목록 */
      .list-input { width: 100%; border: 1px solid #13254C; border-radius: 5px; padding-left: 5px; }
      .list-td {  width: 400px; }
      .table-row-last { text-align: center; }
      /* 빼기 아이콘 */
      .minus-icon { vertical-align: middle; width: 25px; line-height: 25px; }
      .minus-icon-a { cursor: pointer; }
      /* 더하기 아이콘 */
      .plus-icon { vertical-align: middle; width: 25px; line-height: 25px; }
      .plus-icon-a { cursor: pointer; }
      /* 페이지네이션 */
      .pagenation { margin-bottom: 20px; line-height: 30px; }
      .pagenation a { cursor: pointer; margin: 0 5px; }
      .current-page { font-weight: bold; color: red; }
      /* 버튼 */
      .btn-line { display: flex; }
      .page-back { margin: 10px auto; }
      .btn-edit-comple { margin-left: auto; }
      .btn { background-color: #13254C; color: white; }
      .btn:hover { border: 1px solid #13254C; }
  	</style>
</head>

<body>
	<!-- 사이드바 -->
	<th:block th:replace="~{/common/side-bar}"></th:block>
	
	<!-- 컨텐츠 영역 -->
	<div class="content">
		<!-- 안전관리 목록 -->
		<div class="section">
			<h1 class="title">점검표 항목 수정 <img alt="이동" th:src="@{/img/icon-next-b.png}" class="title-next"> 소화기</h1>
			<!-- 제목 -->
			<div class="layout-table">
				<table class="table table-hover">
				  <thead>
				    <tr class="table-row table-head">
				      <th scope="col">No.</th>
				      <th scope="col" class="column-checklist">점검 리스트</th>
				      <th scope="col">상 태</th>
				    </tr>
				  </thead>
				  <tbody id="checklist-body">
				    <tr class="table-row">
				      <th scope="row">1</th>
				      <td class="list-td"><input class="list-input" type="text" value="진료부서-응급의학과-001"></td>
				      <td><a class="minus-icon-a"><img alt="빼기 아이콘" src="/img/minus-icon.png" class="minus-icon"></a></td>
				    </tr>
				  </tbody>
				</table>
				<!-- 더하기 아이콘 -->
				<div class="table-row-last">
					<a class="plus-icon-a"><img alt="더하기 아이콘" src="/img/plus-icon.png" class="plus-icon"></a>
				</div>
				<!-- 페이지네이션 -->
				<div class="pagenation">
					<a id="prev-page">&lt;</a>
					<span id="pagination-numbers"></span>
					<a id="next-page">&gt;</a>
				</div>
			</div>
			<div class="btn-line">
				<div class="page-back">
					<button class="btn" type="submit">뒤로 가기</button>
				</div>
				<div class="registration">
					<button class="btn btn-edit-comple" type="button">수정 완료</button>
				</div>
			</div>
		</div>
	</div>
	<script th:src="@{/js/bootstrap.bundle.min.js}"></script>

	<script>
		// Initial data
		let data = [
			'진료부서-응급의학과-001',
			'진료부서-응급의학과-002',
			'진료부서-응급의학과-003',
			'진료부서-응급의학과-004',
			'진료부서-응급의학과-005',
			'진료부서-응급의학과-006',
			'진료부서-응급의학과-007',
			'진료부서-응급의학과-008',
			'진료부서-응급의학과-009',
			'진료부서-응급의학과-010',
			'진료부서-응급의학과-011',
			'진료부서-응급의학과-012'
		];
		const rowsPerPage = 10;
		let currentPage = 1;

		function renderTable(page) {
			const tbody = document.getElementById('checklist-body');
			tbody.innerHTML = '';
			const start = (page - 1) * rowsPerPage;
			const end = start + rowsPerPage;
			const currentData = data.slice(start, end);

			currentData.forEach((item, index) => {
				const rowNumber = start + index + 1;
				const row = `
					<tr class="table-row">
						<th scope="row">${rowNumber}</th>
						<td class="list-td"><input class="list-input" type="text" value="${item}"></td>
						<td><a class="minus-icon-a"><img alt="빼기 아이콘" src="/img/minus-icon.png" class="minus-icon"></a></td>
					</tr>`;
				tbody.insertAdjacentHTML('beforeend', row);
			});
		}

		function updatePagination() {
			const paginationNumbers = document.getElementById('pagination-numbers');
			paginationNumbers.innerHTML = '';
			const totalPages = Math.ceil(data.length / rowsPerPage);

			for (let i = 1; i <= totalPages; i++) {
				const pageLink = document.createElement('a');
				pageLink.textContent = i;
				pageLink.classList.add('page-number');
				if (i === currentPage) {
					pageLink.classList.add('current-page');
				}
				pageLink.addEventListener('click', () => {
					currentPage = i;
					renderTable(currentPage);
					updatePagination();
				});
				paginationNumbers.appendChild(pageLink);
			}
		}

		// Add event listeners for + and - buttons
		document.addEventListener('click', function (e) {
			if (e.target && e.target.closest('.minus-icon-a')) {
				const row = e.target.closest('tr');
				const rowIndex = Array.from(row.parentNode.children).indexOf(row);
				data.splice((currentPage - 1) * rowsPerPage + rowIndex, 1);
				renderTable(currentPage);
				updatePagination();
			}
		});

		document.querySelector('.plus-icon-a').addEventListener('click', () => {
			data.push(`진료부서-응급의학과-${String(data.length + 1).padStart(3, '0')}`);
			renderTable(currentPage);
			updatePagination();
		});

		// Pagination previous/next
		document.getElementById('prev-page').addEventListener('click', () => {
			if (currentPage > 1) {
				currentPage--;
				renderTable(currentPage);
				updatePagination();
			}
		});

		document.getElementById('next-page').addEventListener('click', () => {
			const totalPages = Math.ceil(data.length / rowsPerPage);
			if (currentPage < totalPages) {
				currentPage++;
				renderTable(currentPage);
				updatePagination();
			}
		});

		// Initial render
		renderTable(currentPage);
		updatePagination();
	</script>
</body>

</html>